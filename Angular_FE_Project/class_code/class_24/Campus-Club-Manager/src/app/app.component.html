<header class="app-header">
  <div class="container app-header-inner">
    <div class="brand">
      <span class="badge">CC</span>
      <span>Campus Club Manager</span>
    </div>
    <nav class="top-nav">
      <a routerLink="/" class="nav-pill">Home</a>
      @if (auth.isAdmin()) { <a routerLink="/clubs/new">New Club</a> } @if
      (auth.isAdmin()) { <a routerLink="/admin/users">Users</a> } @if
      (auth.isAdmin()) { <a routerLink="/tools">Tools</a> } @if (!auth.user()) {
      <a routerLink="/login">Sign in</a>
      } @else {
      <span class="current-user" title="Current user"
        >ðŸ‘¤ {{ auth.user()?.username }}@if (auth.isAdmin()) {
        <span class="chip -danger" style="margin-left: 0.5rem">Admin</span>
        }</span
      >
      <button class="btn btn-ghost btn-sm" (click)="showPin = !showPin">
        Change PIN
      </button>
      <button class="btn btn-outline" (click)="onLogout()">Logout</button>
      }
    </nav>
  </div>
  <div style="border-top: 1px solid var(--border)"></div>
</header>

<div class="subheader">
  <div class="inner">
    <p class="page-summary">{{ pageSummary() }}</p>
  </div>
  <div style="border-top: 1px solid var(--border); opacity: 0.5"></div>
</div>

<app-loading-bar [active]="svc.loading()"></app-loading-bar>
<app-error-banner
  [message]="svc.error()"
  (retry)="onRetry()"
  (dismiss)="svc.error.set(null)"
></app-error-banner>

<main class="app-main container">
  @if (showPin) {
  <div class="modal-overlay" aria-modal="true" role="dialog">
    <div class="modal" (click)="$event.stopPropagation()">
      <app-change-pin (close)="showPin = false" />
    </div>
  </div>
  }
  <router-outlet />
</main>

<app-toast-container />

<app-footer />
